<!DOCTYPE html>
<html lang="en">
    <body style="margin:0px; padding:0px">
    <head>
        <meta charset="utf-8">
        <title>q-binomial coefficient calculator</title>
        <link rel="stylesheet" href="simplestyle.css">
        <script type="text/javascript" async 
            src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
        </script><!-- latex -->
        <script src="js/jquery.js"></script><!-- jquery -->
    </head>
    <div id="blackback">
        <body bgcolor = "white", text = "black">
            <a id="top" class="atop"></a>
            <section class="effect-fade">
                <h1 class="title padding">
                </h1>
            </section>
            <section class="effect-fade">
                <div class="cp_iptxt cp_iptxt4n">
                    <label>n=</label>
                    <input class="ef" id="inputn" type="text" placeholder="">
                    <span class="focus_line"><i></i></span>
                </div>
                <div class="cp_iptxt cp_iptxt4k">
                    <label>k=</label>
                    <input class="ef" id="inputk" type="text" placeholder="">
                    <span class="focus_line"><i></i></span>
                </div>
                <div class="cp_iptxt cp_iptxt4q">
                    <label>q=</label>
                    <input class="ef" id="inputq" type="text" placeholder="">
                    <span class="focus_line"><i></i></span>
                </div>
                <hr class="rline effect-slide-r"></hr>
                <div class="press" id="press"></div>
            </section> 
            <button type="button" id="calbutton" class="calbutton effect-slide-l">calculate</button>
            <div class="error" id="error"></div>
            <br><br><br>
            <div class="math effect-fadeslow" style="display: inline-block">
            \[
            \binom{n}{k}_{q} = 
            \]
            </div>
            <textarea id="result1" type="text" readonly>
                
            </textarea><br>
            <button type="button" id="fmlbutton" class="calbutton effect-slide-l">formula</button><br><br><br>
            <div class="error2" id="error2">

            </div>
            <button type="button" id="copybutton" class="copybutton effect-fade">copy</button>
            <div class="math effect-fadeslow" style="display: inline-block">
            \[
            \binom{n}{k}_{q} = 
            \]
            </div>
            <textarea id="result2" type="text" class="resultlabel2" readonly>
                
            </textarea>
            <br>
            <a id="calc"></a>
            <button type="button" id="visbutton" class="calbutton effect-slide-l">visualize</button><br><br><br><br><br><br>
            <div id="error3">

            </div>
            <div style="position: relative; width: 100%;height:400pt">
                <canvas id="chart01"></canvas>            
            </div>
        </body>
    </div>
    <div id="whiteback">
        <a id="about" ></a>
        <div>About</div>
        <hr id="aboutline"></hr>
        <div  id ="notice1">
            This calculator is developed by Yodai Suzuki. 
            It enables calculations of q-binomial coefficients or polynomials in q that give values of q-binomial coefficients. 
            It also enables a visualization of “q-binomial distribution”. 
            It uses the algorithm which calculates q-binomial coefficients with time complexity O(n^2), and calculates polynomials with time complexity O(k^2(n-k)^2).
        </div><br><br><br><br>
        <div  id="notice2">
            The q-binomial coefficient is also called “Gaussian binomial coefficient”. 
            They are q-analogs of the binomial coefficients. A q-analog is a kind of generalizations which introduce new parameter “q” to some mathematical objects. 
            In a q-analog, q-extended-objects must be the same as the original objects in the limit as q→1. For example, q-number([n]<sub>q</sub>) is defined by the following equation.
            \[
            [n]_{q}=\frac{1-q^{n}}{1-q}
            \]
            The q-factorial and the q-binomial coefficient are defined by the following equation.
            \[
            [n]!_{q}=\prod_{k=1}^{n} [k]_{q}
            \\
            \binom{n}{k}_{q} = \frac{[n]!_{q}}{[k]!_{q}[n-k]!_{q}}
            \]
        </div><br><br><br><br><br>
        <div  id="notice3">
            There are many interpretations of the q-binomial coefficient. 
            The most typical one is understanding the q-binomial coefficient as the number of k-dimensional subspaces of the n-dimensional vector space over the q-element field. 
            It is also important that the coefficient of the polynomial which corresponds to q<sup>i</sup> is equal to the number of “(n-k)*k Young diagram" patterns which contain i blocks. 
            See “Method” for a detailed explanation.
        </div><br><br><br><br><br>
    </div>
    <div id="blackback">
        <div class="explanation1">
            1. The value of the q-binomial coefficient
        </div><br><br><br><br>
        <div class="explanation2">
            Here is the well-known equation of binomial coefficients.
            \[
            \binom{n}{k}=\binom{n-1}{k}+\binom{n-1}{k-1} \ \ \ \ \ ......(1)
            \]
            The following equation which is similar to (1) is true.
            \[
            \binom{n}{k}_{q}=q^{k}\binom{n-1}{k}+\binom{n-1}{k-1} \ \ \ \ \ ......(2)
            \]
            <div class="mathmargin2">(proof)<br></div>
            <div class="mathmargin">
                \[
                {
                    q^{k}\binom{n-1}{k}+\binom{n-1}{k-1} \\
                    = q^{k}\frac{[(n-1)]!_{q}}{[k]!_{q}[n-k-1]!_{q}} + \frac{[(n-1)]!_{q}}{[k-1]!_{q}[n-k]!_{q}} \\
                    = \frac{[(n-1)]!_{q}}{[k]!_{q}[n-k]!_{q}} \left( q^{k}[n-k]_{q}+[k]_{q} \right) \\
                    = \frac{[(n-1)]!_{q}}{[k]!_{q}[n-k]!_{q}} \left( q^{k}\frac{1-q^{n-k}}{1-q} + \frac{1-q^{k}}{1-q} \right) \\
                    = \frac{[(n-1)]!_{q}}{[k]!_{q}[n-k]!_{q}} \left( \frac{1-q^{k}+q^{k}-q^{n}}{1-q} \right) \\
                    = \frac{[(n-1)]!_{q}}{[k]!_{q}[n-k]!_{q}} \left( \frac{1-q^{n}}{1-q} \right) \\
                    = \frac{[n]_{q}[n-1]!_{q}}{[k]!_{q}[n-k]!_{q}} \\
                    = \frac{[n]!_{q}}{[k]!_{q}[n-k]!_{q}} \\
                    = \binom{n}{k}_{q} \ \ \ \ \ \  \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ■
                }
                \]
            </div>
            This calculator calculates the value of the q-binomial coefficient by using the equation (2). 
            At first, it calculates the value of q<sup>i</sup> and saves it in powq[i] variable. 
            Next, it generates the two dimensional array named comq[i][j] and initializes comq[i][0] to 1. 
            By using the value of powq, it calculates the value of “comq[i-1][j-1]+powq[j]*comq[i-1][j]”, and this value is exactly equal to comq[i][j]. 
            By using the preceding algorithm, it is possible to calculate the value of the q-binomial coefficient with time complexity O(n^2).
        </div>
        <div class="explanation1"> <br><br><br>
            2. The polynomial of the q-binomial coefficient
        </div><br><br><br>
        <div class="explanation2">
            Before the calculation of the polynomial, consider the S(n,k) which is “staircase”. It suffices the following proposition. Let P(i,j) be a element of the S(n,k).<br>
            1.	S(n,k) is a set which contains lattice points.<br>
            2.	Both i and j suffice 1<=i<=(n-k) and 1<=j<=k.<br>
            3.	S(i-1,j) is a element of the S(n,k). (i>=2)<br>
            4.	The number of elements which suffice j=J is larger than or equal to that of elements which suffice j=J+1. <br><br>
            Let n be 12, and k be 5. The following diagram (1) is the example of the S(n,k). <br><br>
            <img src="diagram1.png" alt="diagram1" class="diagram1">
            <img src="diagram2.png" alt="diagram2" class ="diagram2"><br><br>
            If we substitute boxes for points, this diagram will be easier to understand(diagram (2)). It exactly seems a “staircase”. This is also called “Young diagram”.<br><br>
            Let C(n,k,i) be the patterns of the S(n,k) which contains i boxes or points. 
            And let Q(n,k,i) be the coefficient of (n k)q which corresponds to the q<sup>i</sup>. 
            C(n,k,i) is equal to Q(n,k,i). This fact is very important and useful when we calculates the polynomial of the q-binomial coefficient.
            <br><br><br>
            <strong>Theorem 1.</strong> C(n,k,i)=Q(n,k,i) <br><br>
            <div class="mathmargin2">(proof)<br></div>
            <div class="mathmargin">
                    When n is equal to 1, let the number of the staircases which contains 0 blocks be 1.
                    The number of those which contains 1 blocks is 1. 
                    These correspondent to the value of (1 0)<sub>q</sub> and (1 1)<sub>q</sub>.
                    Remark recurrence relations of C(n,k,i) and Q(n,k,i).
                    It is obvious from (2) that Q(n,k,i) suffices the following equation (3).
                    \[
                    {
                    Q(n,k,i) = \\
                    \ \ Q(n-1, k, i-k)+Q(n-1, k-1, i) \ \ \  (i>=k) \ \ \ ……(3)     \\
                    \ \ Q(n-1,k-1,i)\ \ \ (i < k) \ \ \ \ \ \ \                 
                    }
                    \]
                    Following considerations about C(n,k,i) are true.<br>
                    1.	Staircases can be classified into two groups according to whether they contain (1,k) or not.<br>
                    2.	The number of the staircases which contain (1,k) is equal to the number of those which delete one column and reduce k blocks. <br>
                    3.	The number of the those which doesn’t contain (1,k) is equal to the number of those which delete one row.<br>
                    The following equation holds because of considerations 2 and 3.<br>
                    \[
                    {
                        C(n,k,i)= \\
                        \ \ C(n-1,k,i-k)+C(n-1,k-1,i)\ \ \ (i>=k) \\
                        \ \ C(n-1,k-1,i)\ \ \ (i < k)
                    }
                    \]
                    Q(n,k,i) and C(n,k,i) suffice the same reccurence relation. Therefore, Q(n,k,i) is equal to C(n,k,i).　■
            </div><br><br>
            For the calculation of the q-binomial coefficients, we need to show the following lemma1 and lemma2.<br><br>
            <strong>Lemma 1.</strong>　Q(n,k,i)=Q(n,k,k(n-k)-i)<br><br>
            <div class="mathmargin2">(proof)</div><br>
            <div class="mathmargin">Think of the “reversal “of the deviation of i. 
                To reverse the deviation, remove all tiles, put tiles in the all position which no tile have put in (diagram(2) to diagram(3)).
                Then rotate the whole diagram 180 degrees (diagram(3) to diagram(4)).
                Let i be the number of tiles which was contained in the previous diagram. 
                New diagram which is created by the preceding process contains k(n-k)-i tiles. 
                By using these steps, the bijection from the deviation which contains i tiles to that which contains k(n-k)-i tiles was materialized. 
                Therefore C(n,k,i) is equal to C(n,k,k(n-k)-i). By using theorem 1, Q(n,k,i) is equal to Q(n,k,k(n-k)-i).　■
            </div><br>
            <img src="diagram2.png" alt="diagram3" class="diagram3">
            <img src="diagram3.png" alt="diagram3" class="diagram3">
            <img src="diagram4.png" alt="diagram4" class ="diagram3"><br><br>    
            <strong>Lemma 2.</strong>　Q(n,k,i-1) <= Q(n,k,i)　(When i <= k(n-k)/2) <br><br>
            <div class="mathmargin2">(proof)</div><br>
            <div class="mathmargin">
                Use the mathematical induction. When it holds when n=N-1 and k=K-1, the following equations are true.<br>
                \[
                {
                Q(N,K, \tfrac{K(N-K)}{2}-1)=Q(N-1,K-1, \tfrac{K(N-K)}{2}-1)+Q(N-1,K,\tfrac{K(N-K-2)}{2}-1) \\
                Q(N,K,\tfrac{K(N-K)}{2})=Q(N-1,K-1,\tfrac{K(N-K)}{2})+Q(N-1,K,\tfrac{K(N-K-2)}{2})        
                }        
                \]
                If we use Lemma1 adequately, we can apply Lemma2 to each terms of the right side. 
                It is clear that Lemma2 holds when k=0 or i=-1. Therefore Lemma2 holds for all n,k and i.
                　■
            </div><br>
            By using these two lemmas, the following Corollary 1 is easily deduced.<br><br>
            <strong>Corollary 1. </strong>Q(n,k,i) is maximized when i is equal to k(n-k)/2.<br><br>
            We can prove the following theorem by using Corollary 1.<br><br>
            <strong>Theorem 2.</strong>  Q(n,k,i) <= <sub>n</sub>C<sub>k</sub> <br><br>
            <div class="mathmargin2">(proof)</div><br>
            <div class="mathmargin">
                
                    From Corollary1, this theorem can be proved if we prove it when i is equal to k(n-k)/2. 
                    Use the matimatical induction. Let it hold when n=N-1 and k=K-1, K.<br>
                    \[
                    {
                    Q(N,K,\tfrac{K(N-K}{2})=Q(N-1,K-1,\tfrac{K(N-K)}{2})+Q(N-1,K,\tfrac{K(N-K-2)}{2}) \\
                    < Q(N-1,K-1,\tfrac{(K-1)(N-K)}{2})+Q(N-1,K,\tfrac{K(N-K-1)}{2}) \\
                    < \binom{N-1}{K-1}+\binom{N-1}{K} \\
                    =\binom{N}{K}
                    }
                    \]
                    When k = 0, it cleary holds because Q(n,0,i) = 1 = <sub>n</sub>C<sub>0</sub>. 
                    It also holds when i=0 because Q(n,k,0)=1 =< <sub>n</sub>C<sub>k</sub>. 
                    Therefore Theorem 2 holds for all n,k and i.
                
            </div><br><br>

            Using theorem 2, Q(n,k,i) is equal to or less than nCk. 
            That means we can calculate the polynomial of the q-binomial coefficients by using the following steps with time complexity O(n^2).<br><br>
            1.   Initialize i to 0. Substitute temp for (n k)_q. Let q be <sub>n</sub>C<sub>k</sub>.<br>
            2.	 The coefficient of q^i is temp % q.<br>
            3.	 Substitute temp for temp / q.<br>
            4.	 Finish if temp is equal to zero. Otherwise substitute i for i+1, and back to the step 2.<br><br>
            This is how it calculates the polynomial of the q-binomial coefficients.<br><br>
            
            We can calculate it in another way.
            This calculator used theorem 1 when it calculates Q(n,k,i) in an obsoleted method. 
            It counts the number of the staircases which corresponds n, k and i
            (It is possible to calculates the value of Q(n,k,i) by using the equation (3), but it is more intuitive to correspond the number of the staircases.).
            <br><br>
            At first, it prepares a three-dimensional array dp[n-k][i][k].
            The variable n-k is the number of columns,  variable i is the number of blocks, k is the number of columns.
            Dp[n-k][i][k] is the number of the staircase patterns which contains i blocks, exactly has k columns, exactly contains n-k blocks in the first row. 
            When n-k is equal to 1, dp[i][j’][j’’] is equal to δ<sub>j’j’’</sub>(δ<sub>j’j’’</sub> is called Kronecker delta). 
            Remark the value of dp[N-K,I,K]. When we add one line to the staircase, the new line must contain N-K blocks and the second line must contain less than or equal to N-K blocks. 
            Therefore, the following eqution holds. 
            \[
            {
            dp[N-K,I,K]=\sum_{k'=0}^{K} \ dp[N-K,I-N+K,K-k’] \ \ ……(4)
            }
            \]
            We can calculate dp[N-K,I,K] with time complexity O(1) by using comulative sum. 
            We can calculate the polynomial of q-binomial coefficient with time complexity O(n^4) which is equal to the number of dp elements(More exactly, we can calculate with time complexity O(k^2(n-k)^2).
            <br><br><br>
            By considering the correspondence to the staircase, it is obvious that q-binomial coefficient represents the number of an integer partition. 
            In other words, the coefficient of q<sup>i</sup> which appears in (n k)<sub>q</sub> is equal to “the pattern of the paritition which divides i into k integers that are less than or equal to n-k”. 
            This is very important fact that relates Rogers-Ramanujan identities.
            </div> 
            <br><br><br>
    </div>

        以下日本語訳<br><br>
        この計算機は鈴木陽大によって開発された。<br>
        q二項係数を与える多項式や、q二項係数の値の計算を行うことができる。<br>
        また、縦軸にn、横軸にkをとった「q二項分布」の様子も見ることができる。<br>
        q二項係数の値と式を時間計算量O(n^2)で計算することが可能である。<br>
        <br>

        q二項係数は、「ガウスの二項係数」とも呼ばれる、二項係数のq類似である。<br>
        ある対象のq類似とは、q→1の極限で元の対象へ一致するようにパラメータqを導入したもののことを言う。例えば、q数[n]qは一般に以下で定義される。<br>
        \[
        [n]_{q}=\frac{1-q^{n}}{1-q}
        \]
        q階乗とq二項係数は、このq数を用いて次のように定義される。<br>
        \[
        [n]!_{q}=\prod_{k=1}^{n} [k]_{q}
        \\
        \binom{n}{k}_{q} = \frac{[n]!_{q}}{[k]!_{q}[n-k]!_{q}}
        \]

        q二項係数には様々な解釈が存在する。<br>
        もっとも典型的なものは、素数のべきqに対してq二項係数は有限体Fq上のn次元線形空間内におけるk次元部分空間の数を与えるというものだ。<br>
        また、q二項係数のq^iに対応する係数は、(n-k)×kの「ヤング図形」においてブロックの総数がi個であるようなものの個数を与える。<br>
        詳細は次のmethodを参照せよ。<br><br>

        Method<br><br>
        １　q二項係数の値<br><br>
        以下は、二項係数に成立する有名な関係式である。<br><br>
        \[
        \binom{n}{k}=\binom{n-1}{k}+\binom{n-1}{k-1} \ \ \ \ \ ......(1)
        \]

        これと類似する以下の式が、q二項係数にも成立する。<br><br>
        \[
        \binom{n}{k}_{q}=q^{k}\binom{n-1}{k}+\binom{n-1}{k-1} \ \ \ \ \ ......(2)
        \]
        <div class="mathmargin2">(証明)<br></div>
        <div class="mathmargin">
            \[
            {
                q^{k}\binom{n-1}{k}+\binom{n-1}{k-1} \\
                = q^{k}\frac{[(n-1)]!_{q}}{[k]!_{q}[n-k-1]!_{q}} + \frac{[(n-1)]!_{q}}{[k-1]!_{q}[n-k]!_{q}} \\
                = \frac{[(n-1)]!_{q}}{[k]!_{q}[n-k]!_{q}} \left( q^{k}[n-k]_{q}+[k]_{q} \right) \\
                = \frac{[(n-1)]!_{q}}{[k]!_{q}[n-k]!_{q}} \left( q^{k}\frac{1-q^{n-k}}{1-q} + \frac{1-q^{k}}{1-q} \right) \\
                = \frac{[(n-1)]!_{q}}{[k]!_{q}[n-k]!_{q}} \left( \frac{1-q^{k}+q^{k}-q^{n}}{1-q} \right) \\
                = \frac{[(n-1)]!_{q}}{[k]!_{q}[n-k]!_{q}} \left( \frac{1-q^{n}}{1-q} \right) \\
                = \frac{[n]_{q}[n-1]!_{q}}{[k]!_{q}[n-k]!_{q}} \\
                = \frac{[n]!_{q}}{[k]!_{q}[n-k]!_{q}} \\
                = \binom{n}{k}_{q} \ \ \ \ \ \  \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ■
            }
            \]
        </div>
        この計算機では、この等式を用いてq二項係数の値を計算している。<br>
        はじめに、q^iをi=0からi=nまで計算し、powq[i]に格納する。<br>
        次に、2次元配列comq[i][j]を用意する。<br>
        i=0からi=nまでcomq[i][0]に1を格納した後、i=1〜nまで、j=1〜kまでループを回す。<br>
        Comq[i][j]には、先ほど計算したpowq[i]を用いてcomq[i-1][j-1]+powq[j]*comq[i-1][j]を格納する。<br>
        iについて昇順にループを回せば、時間計算量O(n^2)でq二項係数の値を求めることができる。<br><br>
        
        ２　多項式 <br><br>

        q二項係数を与える多項式の計算の前に、整数k,n(0<=k<=n)に対してある「階段」S(n,k)を考える。<br>
        ・階段は、格子点からなる集合である<br>
        ・Sに含まれるすべての格子点(i, j)は、1<=i<=(n-k), 1<=j<=kを満たす<br>
        ・i>=2の時、階段に格子点(i, j)が含まれるならば格子点(i-1,j)も階段に含まれる<br>
        ・階段に含まれる格子点(i, j)のうちj=J（1<=J<=k）を満たすものの数は、j=J+1を満たすものの数よりも常に大きいか、等しい<br><br>

        例えばn=12,k=5とした時、以下のdiagram(1)のようなものが階段の一例である。<br><br>
        <img src="diagram1.png" alt="diagram1" class="diagram1">
        <img src="diagram2.png" alt="diagram2" class ="diagram2"><br><br>

        これをさらに分かりやすく、箱を詰めるようにして表示すれば、digram(2)のようになる。<br>
        まさに階段のような見た目をしている。この図形は、ヤング図形とも呼ばれている。<br><br>

        階段S(n,k)のうち、要素数がiであるようなものの個数をC(n,k,i)と定義する。<br>
        この時、C(n,k,i)はq二項係数を与える多項式のq^iの係数Q(n,k,i)と一致することが知られている。<br>
        この事実は非常に強力で、q二項係数を与える多項式を高速に求める様々なアプローチが可能になる。<br><br>

        <strong>定理１</strong>　Q(n,k,i)=C(n,k,i)<br>
        （証明）<br>
        n=1の時、0このブロックを階段状に並べる並べ方を一通りと定める。<br>
        また、1このブロックを階段状に並べる並べ方もただ一通りである。<br>
        これは、(1 0)q=1, (1 1)q=1に対応している……①<br>
        ここで、双方の漸化式に着目する。Q(n,k,i)は先程の式(2)より、<br>
        \[
        {
            Q(n,k,i) = \\
            \ \ Q(n-1, k, i-k)+Q(n-1, k-1, i) \ \ \  (i>=k) \ \ \ ……(3)     \\
            \ \ Q(n-1,k-1,i)\ \ \ (i < k) \ \ \ \ \ \ \                 
            }
            \]
        を満たすことが簡単にわかる。<br>
        一方で、階段状の図形を並べる並べ方C(n,k,i)について、以下の考察が成立する。<br>
        ・階段は、格子点(1,k)が含まれるものと含まれないものに分けることができる<br>
        ・このうち(1,k)が含まれるものの階段の個数は、階段の列数を1つ減らし使うブロックの総数を行数分減らして作られる階段の総数に等しい<br>
        ・(1,k)が含まれないものは、階段の行数を1つ減らして作られる階段の総数に等しい<br>
        ・これらから、<br>
        \[
        {
            C(n,k,i)= \\
            \ \ C(n-1,k,i-k)+C(n-1,k-1,i)\ \ \ (i>=k) \\
            \ \ C(n-1,k-1,i)\ \ \ (i < k)
        }
        \]
        が成立する。<br>

        C(n,k,i)とQ(n,k,i)が同じ漸化式を満たすことと、①より帰納的にC(n,k,i)=Q(n,k,i)が成立する。■<br><br>

        ここで、以下の２つの補題を示す。<br><br>

        <strong>補題１</strong>　Q(n,k,i)=Q(n,k,k(n-k)-i) <br><br>
        ある分割を反転させることを考えよ。<br>
        すなわち、タイルの敷き詰められているところのタイルを全て取り除き、敷き詰められていなかった部分に全てタイルを敷き詰める。<br>
        これを180度回転させることで、新たな分割が得られる。<br>
        この時、反転前に用いているタイルの数はiこ、反転後に用いているタイルの数はk(n-k)-iこであるから、iこのタイルを用いる分割からk(n-k)-iこのタイルを用いる分割への全単射が構成できた。<br>
        したがって、C(n,k,i)=C(n,k,k(n-k)-i)が示された。<br>
        定理１より、Q(n,k,i)=C(n,k,i)であるから、Q(n,k,i)=Q(n,k,k(n-k)-i)が示された。■<br><br>
        <img src="diagram2.png" alt="diagram3" class="diagram3">
        <img src="diagram3.png" alt="diagram3" class="diagram3">
        <img src="diagram4.png" alt="diagram4" class ="diagram3"><br><br>   

        <strong>補題２</strong>　Q(n,k,i-1)<= Q(n,k,i)　(i<= k(n-k)/2) <br>
        数学的帰納法を用いよ。n,kについてn=N-1,k=K-1まで証明されているとする。<br>
        Q(N,K,K(N-K)/ 2-1)=Q(N-1,K-1,K(N-K)/2-1)+Q(N-1,K,K(N-K-2)/2-1)
        Q(N,K,K(N-K)/ 2)=Q(N-1,K-1,K(N-K)/2)+Q(N-1,K,K(N-K-2)/2)
        ここで、各々の右辺の各項に補題１を用いることで数学的帰納法の仮定を適用できる。<br>
        また、Q(n,0,i-1)<= Q(n,0,i) (i=0)、Q(n,k,-1)<= Q(n,k,0)であるから、示された。■<br><br>

        この二つの補題から、以下の系が導かれる。<br><br>
        <strong>系1</strong>　Q(n,k,i)はi=k(n-k)/2で最大値をとる<br><br>

        この系を用いて、以下の定理を示す。<br><br>
        <strong>定理２</strong>　任意のn,k,iについて、Q(n,k,i)< nCk <br>
        系1より、Q(n,k,k(n-k)/ 2)について成立することを示せばよい。<br>
        数学的帰納法を用いよ。n,kについてn=N-1,k=K-1,Kまで証明されているとする。<br>
        \[
        {
        Q(N,K,\tfrac{K(N-K}{2})=Q(N-1,K-1,\tfrac{K(N-K)}{2})+Q(N-1,K,\tfrac{K(N-K-2)}{2}) \\
        < Q(N-1,K-1,\tfrac{(K-1)(N-K)}{2})+Q(N-1,K,\tfrac{K(N-K-1)}{2}) \\
        < \binom{N-1}{K-1}+\binom{N-1}{K} \\
        =\binom{N}{K}
        }
        \]
        これと、Q(n,0,i)=1=nC0、Q(n,k,0)=1=< nCkから、示された。<br><br>

        以上より、Q(n,k,i)をnCkで上から抑えられることが示された。<br>
        したがって、以下の手順でq-binomial coefficientの多項式をO(n^2)で求めることができる。<br>
        1.	i=0とする。(n k)_qにq=nCkを代入した値を計算し、tempに格納する。<br>
        2.	tempをnCkで割ったあまりをq^iの係数とする。<br>
        3.	tempをnCkで割る。<br>
        4.	temp=0なら終了。そうでなければ、i = i+1として2に戻る。<br><br>
        これが、この計算機がq-binomial coefficientsを計算する方法です。<br><br>

        以前の方式では、定理１を用いて、条件を満たすような階段の個数を計算し、q^iに対応する係数を求めていた
        （もちろん漸化式(3)から直接求めることも可能ですが、階段と対応づけた方が直感的である）。<br>
        まず、三次元配列dp[n-k][i][k]を用意する。n-kは階段の列数、iは使用するブロックの総数、kは階段の行数である。<br>
        ここで、dp[n-k][i][k]には「iこのブロックを用いて、先頭の段のブロックがちょうどn-kこで、行数がちょうどkであるような階段の個数」を格納していく。<br>
        dp[1][j1][j2]には、δj’j’’.を格納する。dp[N-K,I,K]の値を考える。行数を増やす時、新しく追加される行は必ずN-Kこのブロックを含む。<br>
        そして、その次の行は階段の定義からN-Kこ以下のブロックを含む。したがって、dp[N-K,I,K]=Σdp[N-K,I-N+K,K-k’] (0<=k’<=K)が成立する。<br>
        3つ目の変数に対する累積和をとっておけば、この更新を1つあたりO(1)で行うことができる。<br>
        最終的な計算量は3次元配列dpの全要素数と同じO(n^4)(より厳密には、O(k^2(n-k)^2))となる。<br><br>

        階段との対応関係を用いれば、q二項係数は整数の分割と対応していることがわかる。<br>
        すなわち、(n k)qのq^iに対応する係数は「整数iを、0以上n-k以下のkこの整数に分割する際の、分割方法の種類数」と等しいことが明らかになる。<br>
        これは、ロジャース・ラマヌジャン恒等式などとも関連する重要な事実である。<br><br>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <script type="text/javascript" src="script.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.bundle.js"></script>
</body>
</html>
